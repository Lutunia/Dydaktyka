---
title: "Zadanie dodatkowe- R Markdown"
author: "Agnieszka"
date: "Sunday, May 24, 2015"
output: html_document
---
#Regresja liniowa
Model regresji możemy zapisać następująco

$$
Y=\beta X+ \epsilon
$$

Natomiast estymator KMNK **$\beta$**  określony jest następująco
$$
\hat{\beta}=(X^TX)^{-1}X^TY
$$

#Dane do regresji
Użyjemy danych ze zbioru `cars`
i zbudujemy model regresji `dist ~ speed`. Dodatkowo, losowo (wykorzystując funkcję `sample` wybierzemy jedynie 20 obserwacji aby dokument był czytelny.

```{r dane_regresja,echo=TRUE, comment=''}
car_sub <- cars[sample(1:50,20),]
```
```{r echo=FALSE}
speed <- car_sub[,1]
distance <- car_sub[,2]
```

Macierz $X$ wygląda następująco
```{r echo=FALSE}
m2l <- function(matr) {
    printmrow <- function(X) {
        ret <- paste(paste(X,collapse = " & "),"\\\\")
        sprintf(ret)
    }
    out <- apply(matr,1,printmrow)
    out2 <- paste("\\begin{bmatrix}",paste(out,collapse=' '),"\\end{bmatrix}")
    return(out2)
}

macierz1=matrix(speed,20,2)
macierz1[1:20,1]=1
X<-macierz1

Y<-matrix(distance)
```
$$
\mathbf{X} = `r m2l(X)`
$$

W związku z tym $\hat{\beta}$ ma następującą postać
$$
(X^TX)^{-1}X^TY=(`r m2l(X)`^T`r m2l(X)`)^{-1}`r m2l(X)`^T`r m2l(Y)`
$$

Co daje nam
$$
\hat{\beta}= (X^{T}X)^{-1}X^{T}Y = (`r m2l(t(X)%*%X)`)^{-1}`r m2l(t(X)%*%Y)`=`r m2l(solve(t(X)%*%X)%*%(t(X)%*%Y))`
$$

#Rysujemy wykres regresji
Wykres przedstawia zależnośc między `dist` a `speed` oraz oszacowaną krzywą regresji. Należy użyć funkcji `plot` oraz `abline`.
```{r echo=FALSE}
model <- lm(distance~speed)

plot(speed,distance,
     xlab = "Prędkość",
     ylab = "Dystans",
     main = "Zależność między dystansem a prędkością")
abline(model, col = "red")
```


